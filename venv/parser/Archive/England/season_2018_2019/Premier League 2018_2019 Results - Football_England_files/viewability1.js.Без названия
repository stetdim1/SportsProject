if(typeof(AdvertViewability)==="undefined"){window.AdvertViewability=function(){this.initialize.apply(this,arguments);if(!this.parentTagId||this.parentTagId.length<=0){window.AdvertViewabilityRegistry.push(this)}else{if(parent.AVP&&parent.AVP.viewabilitySupport){parent.AVP.viewabilityRegistry.push(this)}}};window.AdvertViewabilityRegistry=[];window.AdvertViewability.prototype={initialize:function(d,c,e,h,f,g){this.tagId=d;this.parentTagId=c;this.baseUrl=e;this.beaconUrl=h;this.beaconData=f;if("context" in window&&"initialIntersection" in window.context){var b=function(){return((window.innerWidth*window.innerHeight)>=242500)?0.3:0.5};var a=((window.context.initialIntersection.intersectionRect.width*window.context.initialIntersection.intersectionRect.height)/(window.innerWidth*window.innerHeight));this.viewableState=(this.isPageVisible()&&a>=b())?"viewable":"obscured";this.viewableTime=(this.viewableState=="viewable")?g:null;this.viewableTimeCount=0}else{if(!c||c.length<=0){this.viewableState=(this.isPageVisible()&&this.isCreativeViewable(d))?"viewable":"obscured";this.viewableTime=(this.viewableState=="viewable")?g:null;this.viewableTimeCount=0}else{if(parent.AVP&&parent.AVP.viewabilitySupport){this.viewableState=(parent.AVP.isPageVisible()&&parent.AVP.isCreativeViewable(d,c))?"viewable":"obscured";this.viewableTime=(this.viewableState=="viewable")?g:null;this.viewableTimeCount=0}else{this.viewableState="obscured";this.viewableTime=null;this.viewableTimeCount=0}}}},isPageVisible:function(){if("context" in window&&"hidden" in window.context){return !window.context.hidden}var a=function(){var d=["webkit","moz","ms","o"];if("hidden" in document){return"hidden"}for(var c=0;c<d.length;c++){if((d[c]+"Hidden") in document){return d[c]+"Hidden"}}return null};var b=a();return(b)?!document[b]:true},isCreativeVisible:function(d){var c=document.getElementById(d);if(c){var e=c.getBoundingClientRect();var b=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var g=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(document.compatMode&&document.compatMode=="BackCompat"){b=Math.max(document.body.clientWidth,window.innerWidth||0);g=Math.max(document.body.clientHeight,window.innerHeight||0)}var a=c.clientWidth;var f=c.clientHeight;return(a>0&&f>0&&((e.top>=0&&e.top<g&&((e.left>=0&&e.left<b)||(e.right>0&&e.right<=b)||(e.left<0&&e.right>b)))||(e.top<0&&e.bottom>g&&((e.left>=0&&e.left<b)||(e.right>0&&e.right<=b)||(e.left<0&&e.right>b)))||(e.bottom>=0&&e.bottom<=g&&((e.left>=0&&e.left<b)||(e.right>0&&e.right<=b)||(e.left<0&&e.right>b)))))}else{return false}},isCreativeViewable:function(h){var c=document.getElementById(h);if(c){var k=c.getBoundingClientRect();var d=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var l=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(document.compatMode&&document.compatMode=="BackCompat"){d=Math.max(document.body.clientWidth,window.innerWidth||0);l=Math.max(document.body.clientHeight,window.innerHeight||0)}var a=c.clientWidth;var j=c.clientHeight;var g=(a>0&&j>0&&((k.top>=0&&k.top<l&&((k.left>=0&&k.left<d)||(k.right>0&&k.right<=d)||(k.left<0&&k.right>d)))||(k.top<0&&k.bottom>l&&((k.left>=0&&k.left<d)||(k.right>0&&k.right<=d)||(k.left<0&&k.right>d)))||(k.bottom>=0&&k.bottom<=l&&((k.left>=0&&k.left<d)||(k.right>0&&k.right<=d)||(k.left<0&&k.right>d)))));if(g){var i=(Math.min(k.right,d)-Math.max(k.left,0));var b=(Math.min(k.bottom,l)-Math.max(k.top,0));var f=(i*b);var m=(a*j);var e=(m>=242500)?(0.3*m):(0.5*m);if(f<e){g=false}}return g}else{return false}},startViewableTimeTracking:function(){if(!this.viewableTime&&this.viewableState!="disabled"){this.viewableState="viewable";this.viewableTime=new Date().getTime()}},sendViewableTimeEvent:function(b){var a=b.viewableTimeCount;b.viewableTimeCount=0;return a},finishViewableTimeTracking:function(){if(this.viewableTime){this.viewableState="obscured";this.viewableTimeCount+=(new Date().getTime()-this.viewableTime);this.viewableTime=null}},disableViewableTimeTracking:function(){this.viewableState="disabled";if(this.viewableTime){this.viewableTimeCount+=(new Date().getTime()-this.viewableTime);this.viewableTime=null}}};var viewabilityReporter=function(){if(window.AdvertViewabilityRegistry){var d=null;var h=[];var c=window.AdvertViewabilityRegistry.length;for(var b=0;b<c;b++){var a=window.AdvertViewabilityRegistry[b];d=a.beaconUrl;a.finishViewableTimeTracking();var f=a.sendViewableTimeEvent(a);if(f>=1000){h.push(a.beaconData+"&elapsed="+Math.round(f/1000))}}if(h.length>0){var e=h.join("|");d=d.replace("[type]","viewable");d=d.replace("[name]","time");if("sendBeacon" in navigator){navigator.sendBeacon(d,e)}else{var g=("XMLHttpRequest" in window)?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");g.open("POST",d,false);g.setRequestHeader("Accept","*/*");g.setRequestHeader("Content-Type","text/plain;charset=UTF-8");g.responseType="text/plain";g.send(e)}}}};window.addEventListener("unload",viewabilityReporter);if(window==top){var viewabilityScanner=function(){if(window.AdvertViewabilityRegistry){var c=window.AdvertViewabilityRegistry.length;for(var b=0;b<c;b++){var a=window.AdvertViewabilityRegistry[b];if(a.isPageVisible()&&a.isCreativeViewable(a.tagId)){a.startViewableTimeTracking()}else{a.finishViewableTimeTracking()}}}};window.addEventListener("DOMContentLoaded",viewabilityScanner);window.addEventListener("load",viewabilityScanner);window.addEventListener("resize",viewabilityScanner);window.addEventListener("visibilitychange",viewabilityScanner);window.addEventListener("scroll",viewabilityScanner);setInterval(viewabilityScanner,100)}else{if("context" in window&&"observeIntersection" in window.context){var getViewabilityThreshold=function(){return((window.innerWidth*window.innerHeight)>=242500)?0.3:0.5};window.context.observeIntersection(function(a){a.forEach(function(e){var d=((e.intersectionRect.width*e.intersectionRect.height)/(window.innerWidth*window.innerHeight));if(window.AdvertViewabilityRegistry&&window.AdvertViewabilityRegistry.length>0){var b=window.AdvertViewabilityRegistry[0];if(b.isPageVisible()&&d>=getViewabilityThreshold()){b.startViewableTimeTracking()}else{b.finishViewableTimeTracking()}}})})}else{if(window.AdvertViewabilityRegistry&&window.AdvertViewabilityRegistry.length>0){var ua=navigator.userAgent;if("IntersectionObserver" in window){var getViewabilityThreshold=function(){return((window.innerWidth*window.innerHeight)>=242500)?0.3:0.5};var io=new IntersectionObserver(function(b){for(var c=0;c<b.length;c++){var a=window.AdvertViewabilityRegistry[0];if(a.isPageVisible()&&b[c].intersectionRatio>=getViewabilityThreshold()){a.startViewableTimeTracking()}else{a.finishViewableTimeTracking()}}},{threshold:[getViewabilityThreshold()]});io.observe(document.body)}else{if("mozInnerScreenX" in window){var isCreativeViewableFirefoxLegacy=function(){var c=screen.width;var l=screen.height;var a=window.innerWidth;var k=window.innerHeight;var d=window.mozInnerScreenY;var j=window.mozInnerScreenX;var n=(d+k);var h=(j+a);var g=(a>0&&k>0&&((d>=0&&d<l&&((j>=0&&j<c)||(h>0&&h<=c)))||(n>=0&&n<=l&&((j>=0&&j<c)||(h>0&&h<=c)))));if(g){var i=(j>=0&&j<c)?Math.min((c-j),a):h;var b=(d>=0&&d<l)?Math.min((l-d),k):n;var f=(i*b);var m=(a*k);var e=(m>=242500)?(0.3*m):(0.5*m);if(f<e){g=false}}return g};setInterval(function(){var a=window.AdvertViewabilityRegistry[0];if(a.isPageVisible()&&isCreativeViewableFirefoxLegacy()){a.startViewableTimeTracking()}else{a.finishViewableTimeTracking()}},100)}else{if(ua.indexOf("MSIE")!=-1||ua.indexOf("Trident/")!=-1||ua.indexOf("Edge/")!=-1){var isCreativeViewableMSIELegacy=function(){if((window.innerWidth*window.innerHeight)>=242500){return(document.elementFromPoint((window.innerWidth*0.3),(window.innerHeight*0.3))!=null)||(document.elementFromPoint((window.innerWidth*0.3),(window.innerHeight*0.6))!=null)}else{return(document.elementFromPoint((window.innerWidth*0.5),(window.innerHeight*0.5))!=null)}};setInterval(function(){var a=window.AdvertViewabilityRegistry[0];if(a.isPageVisible()&&isCreativeViewableMSIELegacy()){a.startViewableTimeTracking()}else{a.finishViewableTimeTracking()}},100)}}}}}}};